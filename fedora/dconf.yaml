---
- name: Set appearence
  become_user: "{{ user.name }}"
  block:
    - name: Locale
      dconf:
        key: "/system/locale/region"
        value: "'{{ user.locale }}'"

    - name: Fonts
      block:
        - name: Create fonts directory
          file:
            path: "~/.local/share/fonts"
            state: directory

        - name: Copy SF Mono
          unarchive:
            src: "fedora/theme/SFMono.zip"
            dest: "~/.local/share/fonts"

        - name: Copy IBM Plex Sans
          unarchive:
            src: "fedora/theme/IBMPlexSans.zip"
            dest: "~/.local/share/fonts"

        - name: Update font cache
          command: "fc-cache -fv"

        - name: Set font settings
          dconf:
            key: "{{ item.key }}"
            value: "{{ item.value }}"
          loop:
            - key: "/org/gnome/desktop/interface/monospace-font-name"
              value: "'SF Mono 10'"
            - key: "/org/gnome/desktop/interface/font-name"
              value: "'IBM Plex Sans Medium 10'"
            - key: "/org/gnome/desktop/interface/document-font-name"
              value: "'IBM Plex Sans Medium 10'"
            - key: "/org/gnome/desktop/interface/font-antialiasing"
              value: "'rgba'"
            - key: "/org/gnome/desktop/interface/font-hinting"
              value: "'medium'"

    - name: Wallpaper and screensaver
      block:
        - name: Create wallpaper directory
          file:
            path: "~/.local/share/backgrounds"
            state: directory

        - name: Copy wallpaper
          copy:
            src: "fedora/theme/wallpaper.jpg"
            dest: "~/.local/share/backgrounds/wallpaper.jpg"
            owner: "{{ user.name }}"
            group: "{{ user.name }}"
            mode: "0644"

        - name: Set wallpaper and screensaver settings
          dconf:
            key: "{{ item.key }}"
            value: "{{ item.value }}"
          loop:
            - key: "/org/gnome/desktop/background/picture-uri"
              value: "'file:///home/{{ user.name }}/.local/share/backgrounds/wallpaper.jpg'"
            - key: "/org/gnome/desktop/screensaver/picture-uri"
              value: "'file:///home/{{ user.name }}/.local/share/backgrounds/wallpaper.jpg'"
            - key: "/org/gnome/desktop/background/picture-options"
              value: "'zoom'"
            - key: "/org/gnome/desktop/screensaver/picture-options"
              value: "'zoom'"
            - key: "/org/gnome/desktop/background/color-shading-type"
              value: "'solid'"
            - key: "/org/gnome/desktop/screensaver/color-shading-type"
              value: "'solid'"
            - key: "/org/gnome/desktop/background/primary-color"
              value: "'#000000000000'"
            - key: "/org/gnome/desktop/screensaver/primary-color"
              value: "'#000000000000'"
            - key: "/org/gnome/desktop/background/secondary-color"
              value: "'#000000000000'"
            - key: "/org/gnome/desktop/screensaver/secondary-color"
              value: "'#000000000000'"
            - key: "/org/gnome/desktop/screensaver/lock-delay"
              value: "uint32 0"

    - name: Icon theme
      dconf:
        key: "/org/gnome/desktop/interface/icon-theme"
        value: "'Papirus-Dark'"

    - name: GTK theme
      block:
        - name: Create themes directory
          file:
            path: "~/.local/share/themes"
            state: directory

        - name: Download GTK theme
          unarchive:
            src: "fedora/theme/Mojave-dark-solid.tar.xz"
            dest: "~/.local/share/themes"
            creates: "~/.local/share/themes/Mojave-dark-solid"

        - name: Set GTK theme
          dconf:
            key: "/org/gnome/desktop/interface/gtk-theme"
            value: "'Mojave-dark-solid'"

    - name: Gnome shell
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/org/gnome/shell/enabled-extensions"
          value: "['user-theme@gnome-shell-extensions.gcampax.github.com']"
        - key: "/org/gnome/shell/extensions/user-theme/name"
          value: "'Mojave-dark-solid'"
        - key: "/org/gnome/shell/favorite-apps"
          value: "['firefox.desktop', 'org.gnome.Calendar.desktop', 'org.gnome.Nautilus.desktop', 'teams.desktop', 'slack.desktop', 'code.desktop', '1password.desktop']"

    - name: Cursor theme
      block:
        - name: Create icons directory
          file:
            path: "~/.local/share/icons"
            state: directory

        - name: Download cursor theme
          unarchive:
            src: "fedora/theme/El_Capitan.zip"
            dest: "~/.local/share/icons"
            creates: "~/.local/share/icons/El_Capitan"

        - name: Set cursor theme
          dconf:
            key: "/org/gnome/desktop/interface/cursor-theme"
            value: "'El_Capitan'"

        - name: Set pointer speed
          dconf:
            key: "/org/gnome/desktop/peripherals/mouse/speed"
            value: "-0.5053003533568905"

    - name: Window manager settings
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/org/gnome/desktop/wm/preferences/button-layout"
          value: "'close,minimize,maximize:appmenu'"
        - key: "/org/gnome/desktop/wm/preferences/mouse-button-modifier"
          value: "'<Alt>'"
        - key: "/org/gnome/desktop/wm/preferences/titlebar-font"
          value: "'IBM Plex Sans Semi-Bold 10'"

    - name: Nautilus settings
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/org/gnome/nautilus/preferences/default-folder-viewer"
          value: "'icon-view'"
        - key: "/org/gnome/nautilus/preferences/search-view"
          value: "'list-view'"
        - key: "/org/gnome/nautilus/icon-view/default-zoom-level"
          value: "'small'"

    - name: Guake settings
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/apps/guake/general/compat-delete"
          value: "'delete-sequence'"
        - key: "/apps/guake/general/display-n"
          value: "-1"
        - key: "/apps/guake/general/display-tab-names"
          value: "0"
        - key: "/apps/guake/general/fullscreen-hide-tabbar"
          value: "false"
        - key: "/apps/guake/general/gtk-prefer-dark-theme"
          value: "true"
        - key: "/apps/guake/general/history-size"
          value: "10000"
        - key: "/apps/guake/general/max-tab-name-length"
          value: "100"
        - key: "/apps/guake/general/mouse-display"
          value: "true"
        - key: "/apps/guake/general/new-tab-after"
          value: "true"
        - key: "/apps/guake/general/open-tab-cwd"
          value: "true"
        - key: "/apps/guake/general/prompt-on-quit"
          value: "true"
        - key: "/apps/guake/general/quick-open-command-line"
          value: "'gedit %(file_path)s'"
        - key: "/apps/guake/general/restore-tabs-notify"
          value: "true"
        - key: "/apps/guake/general/restore-tabs-startup"
          value: "true"
        - key: "/apps/guake/general/save-tabs-when-changed"
          value: "true"
        - key: "/apps/guake/general/scroll-keystroke"
          value: "true"
        - key: "/apps/guake/general/set-window-title"
          value: "false"
        - key: "/apps/guake/general/start-at-login"
          value: "true"
        - key: "/apps/guake/general/tab-close-buttons"
          value: "true"
        - key: "/apps/guake/general/tab-ontop"
          value: "false"
        - key: "/apps/guake/general/use-default-font"
          value: "true"
        - key: "/apps/guake/general/use-popup"
          value: "true"
        - key: "/apps/guake/general/use-scrollbar"
          value: "false"
        - key: "/apps/guake/general/use-trayicon"
          value: "false"
        - key: "/apps/guake/general/window-halignment"
          value: "0"
        - key: "/apps/guake/general/window-height"
          value: "52"
        - key: "/apps/guake/general/window-losefocus"
          value: "false"
        - key: "/apps/guake/general/window-refocus"
          value: "false"
        - key: "/apps/guake/general/window-tabbar"
          value: "true"
        - key: "/apps/guake/general/window-width"
          value: "100"
        - key: "/apps/guake/keybindings/global/show-hide"
          value: "'<Primary>quotedbl'"
        - key: "/apps/guake/style/cursor-shape"
          value: "2"
        - key: "/apps/guake/style/background/transparency"
          value: "64"
        - key: "/apps/guake/style/font/allow-bold"
          value: "true"
        - key: "/apps/guake/style/font/palette"
          value: "'#878787878787:#FFFF66660000:#CCCCFFFF0404:#FFFFCCCC0000:#4444B3B3CCCC:#99993333CCCC:#4444B3B3CCCC:#F5F5F5F5F5F5:#555555555555:#FFFF00000000:#0000FFFF0000:#FFFFFFFF0000:#00000000FFFF:#FFFF0000FFFF:#0000FFFFFFFF:#E5E5E5E5E5E5:#FFFFFFFFFFFF:#000000000000'"
        - key: "/apps/guake/style/font/palette-name"
          value: "'Vibrant Ink'"

    - name: Gnome Tweaks
      dconf:
        key: "/org/gnome/tweaks/show-extensions-notice"
        value: "false"

    - name: Calendar and clock
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/org/gnome/desktop/interface/clock-show-seconds"
          value: "true"
        - key: "/org/gnome/desktop/interface/clock-show-weekday"
          value: "false"
        - key: "/org/gnome/desktop/calendar/show-weekdate"
          value: "false"

    - name: Gedit
      dconf:
        key: "{{ item.key }}"
        value: "{{ item.value }}"
      loop:
        - key: "/org/gnome/gedit/plugins/active-plugins"
          value: "['spell', 'sort', 'modelines', 'filebrowser', 'docinfo']"
        - key: "/org/gnome/gedit/preferences/editor/scheme"
          value: "'cobalt'"
        - key: "/org/gnome/gedit/preferences/ui/show-tabs-mode"
          value: "'auto'"
